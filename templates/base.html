{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Koru Mission Hospital</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'clinicapp/css/open-iconic-bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/animate.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/aos.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/ionicons.min.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/bootstrap-datepicker.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/jquery.timepicker.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/flaticon.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/icomoon.css' %}">
    <link rel="stylesheet" href="{% static 'clinicapp/css/style.css' %}">

    <style>
      /* WhatsApp Button Styling */
      #whatsappButton {
          background-color: #25D366; /* WhatsApp green */
          color: white;
          border: none;
          padding: 8px 10px;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
          border-radius: 50px;
          position: fixed;
          bottom: 20px;
          right: 20px;
          z-index: 1000;
          box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
          display: flex;
          align-items: center;
          gap: 5px;
      }

      /* WhatsApp Icon */
      #whatsappButton i {
          font-size: 20px;
      }

      /* WhatsApp Modal Styling */
      .whatsapp-modal {
          display: none; /* Hidden by default */
          position: fixed;
          z-index: 1001;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          overflow: auto;
          background-color: rgba(0, 0, 0, 0.5); /* Black with opacity */
      }

      .whatsapp-modal-content {
          background-color: rgb(250, 246, 246);
          padding: 20px;
          max-width: 400px;
          border-radius: 20px;
          text-align: center;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
          border-radius: 50px;
          position: fixed;
          bottom: 80px; /* Adjusted to be above WhatsApp button */
          right: 20px;
          z-index: 1000;
          box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
          display: flex;
          flex-direction: column;
          align-items: center;
      }

      .whatsapp-close {
          color: #0c0c0c;
          align-self: flex-end;
          font-size: 28px;
          font-weight: bold;
          cursor: pointer;
      }

      .whatsapp-close:hover {
          color: black;
      }

      #startChatButton {
          background-color: #25D366;
          color: white;
          border: none;
          padding: 10px 20px;
          font-size: 16px;
          cursor: pointer;
          border-radius: 5px;
          margin-top: 20px;
      }
      
      /* Modal styles */
      .donation-modal .modal-header {
          background-color: #6DBDDF;
          color: white;
          border-radius: 5px 5px 0 0;
      }
      
      .donation-modal .modal-content {
          border-radius: 10px;
      }
      
      .donation-modal .close {
          color: white;
      }
    </style>
  </head>
  <body>
    
    <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
      <div class="container">
        <a class="navbar-brand" href="{% url 'home' %}">Koru <span>Mission Hospital</span></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="oi oi-menu"></span> Menu
        </button>

        <div class="collapse navbar-collapse" id="ftco-nav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item active"><a href="{% url 'home' %}" class="nav-link">Home</a></li>
            <li class="nav-item"><a href="{% url 'about' %}" class="nav-link">About</a></li>
            <li class="nav-item"><a href="{% url 'services' %}" class="nav-link">Services</a></li>
            <li class="nav-item"><a href="{% url 'team' %}" class="nav-link">Our Team</a></li>
            <li class="nav-item"><a href="{% url 'blog:blog_home' %}" class="nav-link">Blog</a></li>
            <li class="nav-item"><a href="{% url 'contact' %}" class="nav-link">Contact</a></li>
            <li class="nav-item cta"><a href="#" class="nav-link" data-toggle="modal" data-target="#modalDonation"><span>Donate Now</span></a></li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- END nav -->

    {% block content %}
    {% endblock %}

    <footer class="ftco-footer ftco-bg-dark ftco-section">
      <div class="container">
        <div class="row mb-5">
          <div class="col-md-3">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">KoruMission.</h2>
              <p>At Koru Mission Hospital, we are dedicated to providing compassionate and high-quality healthcare for you and your family. Your well-being is our mission.</p>
            </div>
            <ul class="ftco-footer-social list-unstyled float-md-left float-lft ">
              <li class="ftco-animate"><a href="#"><span class="icon-twitter"></span></a></li>
              <li class="ftco-animate"><a href="#"><span class="icon-facebook"></span></a></li>
              <li class="ftco-animate"><a href="#"><span class="icon-instagram"></span></a></li>
            </ul>
          </div>
          <div class="col-md-2">
            <div class="ftco-footer-widget mb-4 ml-md-5">
              <h2 class="ftco-heading-2">Quick Links</h2>
              <ul class="list-unstyled">
                <li><a href="#" class="py-2 d-block">About</a></li>
                <li><a href="#" class="py-2 d-block">Features</a></li>
                <li><a href="#" class="py-2 d-block">Projects</a></li>
                <li><a href="#" class="py-2 d-block">Blog</a></li>
                <li><a href="#" class="py-2 d-block">Contact</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-4 pr-md-4">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">Recent Blog</h2>
              {% for recent_post in recent_posts %}
              <div class="block-21 mb-4 d-flex">
                <a class="blog-img mr-4" style="background-image: url('{{ recent_post.image.url }}');"></a>
                <div class="text">
                  <h3 class="heading"><a href="{{ recent_post.get_absolute_url }}">{{ recent_post.title }}</a></h3>
                  <div class="meta">
                    <div><a href="#"><span class="icon-calendar"></span> Sept 15, 2018</a></div>
                    <div><a href="#"><span class="icon-person"></span> Admin</a></div>
                    <div><a href="#"><span class="icon-chat"></span> 19</a></div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="col-md-3">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">Office</h2>
              <div class="block-23 mb-3">
                <ul>
                  <li><span class="icon icon-map-marker"></span><span class="text">Kisumu, Kenya</span></li>
                  <li><a href="#"><span class="icon icon-phone"></span><span class="text">+254 712 345 678</span></a></li>
                  <li><a href="#"><span class="icon icon-envelope"></span><span class="text">korumissionhospital.co.ke</span></a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 text-center">
            <p>
              Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | Koru Mission Hospital
            </p>
          </div>
        </div>
      </div>
    </footer>
    
    <!-- WhatsApp Floating Button -->
    <button id="whatsappButton">
      <i class="icon-whatsapp"></i> WhatsApp
    </button>

    <!-- WhatsApp Popup Modal -->
    <div id="whatsappPopup" class="whatsapp-modal">
      <div class="whatsapp-modal-content">
        <span class="whatsapp-close">&times;</span>
        <p>Welcome to The Koru Mission Hospital.</p>
        <p>We Reply within 24 Hours.</p>
        <br><br>
        <p>Thank You For Contacting Us</p>
        <button id="startChatButton">Start Chat</button>
      </div>
    </div>
    
    <!-- Donation Modal -->
    <div class="modal fade donation-modal" id="modalDonation" tabindex="-1" role="dialog" aria-labelledby="modalDonationTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalDonationTitle">Make a Donation</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form method="post" action="{% url 'process_donation' %}" id="donationForm">
              {% csrf_token %}
              
              <!-- Donor Details -->
              <div class="form-group">
                <label for="name">Name</label>
                <input type="text" class="form-control" id="name" name="name" required>
              </div>
              
              <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" name="email" required>
              </div>
              
              <div class="form-group">
                <label for="amount">Amount</label>
                <input type="number" class="form-control" id="amount" name="amount" min="1" required>
              </div>
              
              <div class="form-group">
                <label for="currency">Currency</label>
                <select class="form-control" id="currency" name="currency">
                  <option value="KES">Kenyan Shilling (KES)</option>
                  <option value="USD">US Dollar (USD)</option>
                  <option value="EUR">Euro (EUR)</option>
                  <option value="GBP">British Pound (GBP)</option>
                </select>
              </div>
              
              <!-- Payment Method -->
              <div class="form-group">
                <label for="payment_method">Payment Method</label>
                <select class="form-control" id="payment_method" name="payment_method" onchange="togglePaymentFields()">
                  <option value="mpesa">M-Pesa</option>
                  <option value="card">Credit/Debit Card</option>
                  <option value="paypal">PayPal</option>
                  <option value="other">Other</option>
                </select>
              </div>
              
              <!-- M-Pesa Details (Hidden by Default) -->
              <div id="mpesa_details" style="display: none;">
                <div class="form-group">
                  <label for="mpesa_phone">Phone Number</label>
                  <input type="tel" class="form-control" id="mpesa_phone" name="mpesa_phone" 
                         placeholder="+254700000000" >
                  <small class="text-muted">Enter your M-Pesa registered phone number to receive a payment prompt.</small>
                </div>
              </div>
              
              <!-- Credit Card Details (Hidden by Default) -->
              <div id="credit_card_details" style="display: none;">
                <div class="form-group">
                  <label for="card_number">Card Number</label>
                  <input type="text" class="form-control" id="card_number" name="card_number" 
                         placeholder="1234 5678 9012 3456" maxlength="16" >
                </div>
                
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="expiry_date">Expiry Date</label>
                    <input type="text" class="form-control" id="expiry_date" name="expiry_date" 
                           placeholder="MM/YY" maxlength="5" >
                  </div>
                  <div class="form-group col-md-6">
                    <label for="cvv">CVV</label>
                    <input type="text" class="form-control" id="cvv" name="cvv" 
                           placeholder="123" maxlength="3" >
                  </div>
                </div>
                
                <div class="form-group">
                  <label for="card_holder_name">Cardholder Name</label>
                  <input type="text" class="form-control" id="card_holder_name" name="card_holder_name" 
                         placeholder="John Doe" >
                </div>
              </div>
              
              <!-- PayPal Details (Hidden by Default) -->
              <div id="paypal_details" style="display: none;">
                <div class="form-group">
                  <label for="paypal_email">PayPal Email</label>
                  <input type="email" class="form-control" id="paypal_email" name="paypal_email" 
                         placeholder="example@example.com">
                  <small class="text-muted">Enter your PayPal email address to complete the payment.</small>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="submit" form="donationForm" class="btn btn-primary">Proceed to Payment</button>
          </div>
        </div>
      </div>
    </div>
  
    <!-- loader -->
    <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>
  
    <script src="{% static 'clinicapp/js/jquery.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery-migrate-3.0.1.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/popper.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery.easing.1.3.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery.stellar.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/aos.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery.animateNumber.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/bootstrap-datepicker.js' %}"></script>
    <script src="{% static 'clinicapp/js/jquery.timepicker.min.js' %}"></script>
    <script src="{% static 'clinicapp/js/scrollax.min.js' %}"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
    <script src="{% static 'clinicapp/js/google-map.js' %}"></script>
    <script src="{% static 'clinicapp/js/main.js' %}"></script>
    
    <!-- Script for toggling payment fields -->
    <script>
      function togglePaymentFields() {
        const paymentMethod = document.getElementById('payment_method').value;
        const mpesaDetails = document.getElementById('mpesa_details');
        const creditCardDetails = document.getElementById('credit_card_details');
        const paypalDetails = document.getElementById('paypal_details');

        // Hide all fields initially
        mpesaDetails.style.display = 'none';
        creditCardDetails.style.display = 'none';
        paypalDetails.style.display = 'none';

        // Show fields based on selected payment method
        if (paymentMethod === 'mpesa') {
          mpesaDetails.style.display = 'block';
        } else if (paymentMethod === 'card') {
          creditCardDetails.style.display = 'block';
        } else if (paymentMethod === 'paypal') {
          paypalDetails.style.display = 'block';
        }
      }

      // Call on page load
      document.addEventListener('DOMContentLoaded', togglePaymentFields);
    </script>
    
    <!-- Script for WhatsApp functionality -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get elements
        const whatsappButton = document.getElementById('whatsappButton');
        const whatsappPopup = document.getElementById('whatsappPopup');
        const closeButton = document.querySelector('.whatsapp-close');
        const startChatButton = document.getElementById('startChatButton');

        // Open popup when WhatsApp button is clicked
        if (whatsappButton) {
          whatsappButton.addEventListener('click', () => {
            whatsappPopup.style.display = 'block';
          });
        }

        // Close popup when close button is clicked
        if (closeButton) {
          closeButton.addEventListener('click', () => {
            whatsappPopup.style.display = 'none';
          });
        }

        // Redirect to WhatsApp Web when Start Chat button is clicked
        if (startChatButton) {
          startChatButton.addEventListener('click', () => {
            const phoneNumber = '254798681754'; // WhatsApp number
            const message = 'Hello, I would like to chat with The Koru Mission Hospital.';
            
            // Detect if user is on mobile or desktop
            const isMobile = /iPhone|Android|iPad/i.test(navigator.userAgent);
            let whatsappUrl;

            if (isMobile) {
              // Use mobile-friendly WhatsApp link
              whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            } else {
              // Use direct WhatsApp Web link for desktop users
              whatsappUrl = `https://web.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(message)}`;
            }

            // Open WhatsApp chat in a new tab
            const newTab = window.open(whatsappUrl, '_blank');

            // If popup is blocked, open in the same tab
            if (!newTab) {
              window.location.href = whatsappUrl;
            }

            // Close popup after redirecting
            whatsappPopup.style.display = 'none';
          });
        }

        // Close popup if user clicks outside the modal
        window.addEventListener('click', (event) => {
          if (event.target === whatsappPopup) {
            whatsappPopup.style.display = 'none';
          }
        });
      });
    </script>
    <!-- <script>
      document.getElementById('donationForm').addEventListener('submit', function(event) {
  event.preventDefault(); // Prevent default form submission
  console.log('Form submitted!'); // Log to the console
  // Add your custom logic here
});
    </script> -->
  </body>
</html>